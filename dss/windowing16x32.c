#include "mmwave_lib.h"
//const int nfft = 256;
extern void windowing16x32_asm(const cmplx16ImRe_t *data,const int *win, cmplx32ImRe_t *out, short *shuffle_l, short *shuffle_h, short *shuffle_x2_l, short *shuffle_x2_h);
//original data
//short data_o[] = {
//		-3660,6525,-9197,3130,-6236,-9149,3009,-13145,15721,-7921,19598,6958,13266,17142,1517,24726,-12255,24509,-20898,16396,-24316,3997,-19381,-7512,-15144,-13314,-2383,-16636,6115,-14566,7801,-7680,8788,-2889,2359,3708,0,5200,-4502,-530,-5080,-5104,4189,-11195,10714,-2985,15384,-939,13795,8908,7439,18009,-4743,19598,-12062,12592,-10882,3009,-5754,3708,-2961,1083,-6115,3997,-8282,8739,-10858,1998,-19935,-1011,-20464,-5513,-13964,-13964,-7175,-14373,2408,-19911,5899,-14205,7247,-12134,16805,-9317,18298,602,14590,7921,11990,13795,3395,12712,-4550,11773,-3009,16058,-3298,12905,-7150,14927,-11845,16901,-18972,10593,-24702,3611,-27398,-2239,-24678,-12375,-18923,-18105,-12255,-25135,1661,-29083,8932,-26074,17022,-18851,17166,-7126,15938,-819,14807,4984,7463,9197,674,5778,-2119,3226,891,-2889,6621,-915,4526,9678,1589,11340,-1156,12062,-9606,14445,-18611,8426,-18875,602,-18490,-9606,-14229,-18586,-1059,-21524,4936,-15601,8451,-5658,8065,-3202,2095,-2504,2672,-5778,2937,-7632,5297,-4598,10954,-3009,8788,1059,9245,8402,7319,11653,217,13940,-7295,14229,-12640,9727,-13145,2769,-13627,0,-11123,-3106,-8523,-7632,-3876,-7102,-2287,-7271,-6741,-8306,-4382,-5273,-1709,-8523,-2383,-11869,3178,-12062,6452,-11966,7656,-9775,8378,-3924,7584,-2793,5706,2215,9799,-1589,8691,3443,8812,9245,6597,10328,-1613,15023,-8234,14807,-16034,11027,-25448,-915,-21042,-13434,-12423,-21596,-482,-23739,12158,-19068,13675,-8282,12760,-48,3804,2913,-3635,-794,-5152,-7873,-1950,-14638,5754,-19646,17142,-13386,23426,1083,23377,9293,17960,21138,4334,28265,-14181,26820,-27157,11340,-25617,-5658,-16829,-18057,-3226,-23137,13362,-11917,19453,-963,10738,10208,-1926,10641,-11773,1806,-15071,-6597,-7439,-14758,2022,-19429,11364,-16371,16468,-11243,18731,-4310,16684,4719,13001,11677,4671,11990,-3058,14686,-9486,11267,-15553,5754,-9582,-2961,-2022,-7271,-313,-5032,4358,3058,2961,5874,-4911,3154,-10160,3034,-13964,-4743,-11725,-12062,-8041,-17118,-72,-25279,12953,-21066,18731,-16829,21187,-5802,21379,4719,14638,15433,4647,18490,-6260,10666,-14084,3154,-6982,-8980,2745,-14710,13434,-12351,20705,3322,15601,11075,5561,15240,-2119,16973,-13988,11123,-20151,3371,-15312,-8162,-9462,-14590,-72,-15914,4839,-15168,11942,-12568,12158,-2648,11821,3034,4767,385,-5658,-2408,-1420,-10425,6115,-16540,22703,-11316,29758,819,31635,16420,21813,29396,8234,32767,-7391,31347,-19694,24413,-27278,14469,-28674,3684,-24822,-9077,-17888,-18370,-11243,-22126,-193,-24533,10377,-22776,11436,-14084,11845,-7199,9967,-5778,13482,-7825,14012,-7680,14036,-4815,18081,-1854,22655,4213,20633,8523,17912,16058,10040,21524,-3058,27494,-9438,24052,-19598,12399,-22053,4285,-15312,-8210,-3178,-15071,6886,-7776,6356,-2552,1854,698,-3948,4237,-5778,-1156,-4887,-7560,578,-14349,9173,-16107,13603,-14132,22439,-8812,23739,6862,19718,16420,14036,21283,1733,21716,-7897,17768,-14036,10473,-12399,433,-2287,-6260,3347,-2335,4767,4310,3563,10690,-3972,15721,-12784,9967,-18851,-3924,-18033,-13844,-7367,-21042,3684,-21620,17166,-19116,22583,-12832,22631,-5899,23185,6212,18177,17792,10328,21740};
//window
//int H[] = {
//		2621,2626,2640,2663,2695,2736,2786,2845,2913,2990,3077,3172,3275,3388,3509,3639,3778,3924,4080,4243,4415,4595,4782,4978,5181,5392,5610,5836,6069,6308,6555,6809,7069,7336,7608,7888,8173,8463,8760,9061,9368,9681,9998,10319,10645,10976,11310,11648,11990,12336,12685,13036,13391,13748,14108,14470,14833,15199,15566,15934,16303,16674,17044,17416,17787,18158,18529,18900,19270,19639,20006,20372,20737,21100,21461,21819,22175,22528,22878,23226,23569,23910,24246,24578,24907,25231,25550,25864,26174,26478,26778,27071,27359,27641,27917,28187,28450,28707,28957,29201,29437,29666,29888,30103,30310,30509,30701,30885,31060,31228,31387,31538,31681,31815,31941,32058,32166,32265,32356,32438,32510,32574,32629,32674,32711,32738,32757,32766,32766,32757,32738,32711,32674,32629,32574,32510,32438,32356,32265,32166,32058,31941,31815,31681,31538,31387,31228,31060,30885,30701,30509,30310,30103,29888,29666,29437,29201,28957,28707,28450,28187,27917,27641,27359,27071,26778,26478,26174,25864,25550,25231,24907,24578,24246,23910,23569,23226,22878,22528,22175,21819,21461,21100,20737,20372,20006,19639,19270,18900,18529,18158,17787,17416,17044,16674,16303,15934,15566,15199,14833,14470,14108,13748,13391,13036,12685,12336,11990,11648,11310,10976,10645,10319,9998,9681,9368,9061,8760,8463,8173,7888,7608,7336,7069,6809,6555,6308,6069,5836,5610,5392,5181,4978,4782,4595,4415,4243,4080,3924,3778,3639,3509,3388,3275,3172,3077,2990,2913,2845,2786,2736,2695,2663,2640,2626,2621
//};
short shuffle_l[] = {
		32,0,32,1,32,2,32,3,32,4,32,5,32,6,32,7,32,8,32,9,32,10,32,11,32,12,32,13,32,14,32,15
};
short shuffle_h[] = {
		32,16,32,17,32,18,32,19,32,20,32,21,32,22,32,23,32,24,32,25,32,26,32,27,32,28,32,29,32,30,32,31
};
short shuffle_x2_l[] = {
		0,1,0,1,2,3,2,3,4,5,4,5,6,7,6,7,8,9,8,9,10,11,10,11,12,13,12,13,14,15,14,15
};
short shuffle_x2_h[] = {
		16,17,16,17,18,19,18,19,20,21,20,21,22,23,22,23,24,25,24,25,26,27,26,27,28,29,28,29,30,31,30,31
};
void windowing_16x32(const cmplx16ImRe_t *inp, const int *win, cmplx32ImRe_t *out, int len) {

	int q = len / 16;
	set_vpsel(1);
	for (int i = 0; i < q; i++) {
		windowing16x32_asm(&(inp[i * 16]), &(win[i * 16]), &(out[i * 16]), shuffle_l, shuffle_h, shuffle_x2_l, shuffle_x2_h);
	}

}
//cmplx16ImRe_t data[nfft];
//cmplx32ImRe_t out_w[nfft];
//int main(){
//
//	data2cplx(data_o, data, nfft);
//	windowing_16x32(data, H, out_w, nfft);
//	return 0;
//}
